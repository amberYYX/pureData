[TOC]

姓名：姚懿烜

班级：2014211601

学号：2014210706

# 作业七 粒子合成

## 实验原理

​	phasor~波表查找函数，当频率设置为f=1/T=N/length（N为采样频率44100，length为音频文件长度），采样点设置为length时，利用其对原素材进行查找，相当于对原声音素材实现复读机重复播放的功能。

​	在此基础上，当phasor~ 频率f与采样点数n满足，N=f*n时，利用samphold~函数，将phasor~进行处理，使其每次查找的起始点线性搬移，从而实现原音，原速。之后，调整粒子采集的phasor~的频率，音频的音调也会随之增加，但是因为samphold~函数的搬移，音频速度不会发生变化，从而实现，变调不变速的处理。

​	当实现复读功能的phasor~频率增加时，计算对应采样phasor~需要的每次粒子采样点的起始点，利用metro对其进行获取，分别输入多个采样器phasor~，采样器根据起始点不同，采集变速复读机处理后的原音频（音调不变），然后进行播放。多个采样器彼此重叠部分，从而实现，变速不变调。

​	采用两个采样phasor~，使其叠加50%，可实现2倍速。

## 实验过程

#### 原速，原调

![屏幕快照 2017-04-25 13.52.00](/Users/yaoyixuan/Desktop/数字音频处理/Granular/屏幕快照 2017-04-25 13.52.00.png)

#### 原速，变调

![屏幕快照 2017-04-25 13.52.30](/Users/yaoyixuan/Desktop/数字音频处理/Granular/屏幕快照 2017-04-25 13.52.30.png)

#### 原调，变速

​	为保持原调，采样phasor~的频率和采样点乘积必须等于音频采样点44100（在此，取172Hz，256点）。

![屏幕快照 2017-04-25 16.30.08副本](/Users/yaoyixuan/Desktop/屏幕快照 2017-04-25 16.30.08副本.png)

​	共计n=172*2=344个粒子采样点。

​	每个粒子的时间长度为1*1000/172ms。

​	没有实现。

#### 异步粒子合成

_part 1_



![get file](/Users/yaoyixuan/Desktop/get file.png)

​	读取文件，根据文件长度和采样频率获得phasor~参数，实现复读机效果。同时，将文件长度作为一个数字发送。将复读机phasor~作为一个信号发送。

_part 2_

![slider](/Users/yaoyixuan/Desktop/slider.png)

​	通过滑动条设置数字自定义数字参数，并将该数字发送。

​	snapshot~每隔500ms，从复读机锯齿函数上取该时刻的对应数值。

_part 3_

![main](/Users/yaoyixuan/Desktop/main.png) 



​	粒子长度/密度，得到的数值作为metro的触发的间隔时间（密度越大，采样点之间的间隔越小），将信号处理后，变为0~7不断循环的整数。同时，利用snapshot~获取该时刻复读机锯齿函数的数值，将两者打包。分发到8个不同的采样处理器中。

_part 4_

![grain](/Users/yaoyixuan/Desktop/grain.png)

​	获得的输入为复读机锯齿函数的该时刻的值，将其与文件大小相乘，获得取样器开始取样的点的位置。

​	粒子长度*音高，进入vline~函数，求得变调的参数（类似phasor~），pitch越大，vline~斜率越大，变调越高。粒子长度\*44100/1000，这一步，不清楚是在处理什么。

​	通过加法器，将vline~处理过的查找器点起始位置搬移到所设置的位置。

​	用该查找器对原音频进行查找播放。

8个采样器轮流采样，彼此重叠，当密度较大时，重叠产生的类似撞击噪音明显。



#### 异步合成之random

​	大多数参数，都和随机数进行处理，完全随机。混乱。

![屏幕快照 2017-04-25 23.06.51](/Users/yaoyixuan/Desktop/屏幕快照 2017-04-25 23.06.51.png)

​	

​	尝试着 自己写了处理函数，一直有问题，没有音频输出。调试不出来。遂弃之。

## 实验结果

​	见附件。